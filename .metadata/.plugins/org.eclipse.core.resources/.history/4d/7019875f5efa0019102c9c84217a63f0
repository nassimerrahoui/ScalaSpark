package TP4

import org.apache.spark.SparkConf
import org.apache.spark.SparkContext

object StereoPrix extends App {
  val conf = new SparkConf().setAppName("Stereo Prix").setMaster("local[*]")
  val spark = new SparkContext(conf)
  
  val rdd1 = spark.textFile("stereoprix_1fichier_de_1ko/stereoprix_fichier_1", 1)
  val rdd2 = rdd1.map(line => line.split(" "))
  val rdd3 = rdd2.map(line => line(0).split("_"))
  //val rdd4 = rdd3.filter(annee => annee.toInt > 2013 && annee.toInt < 2019)
  val rdd4 = rdd3.filter(annee => annee(2).toInt == 2019)
  val rdd5 = rdd4.map(l => l.toString())
  rdd5.saveAsTextFile("stereoprix_1fichier_de_1ko/out.txt")
}